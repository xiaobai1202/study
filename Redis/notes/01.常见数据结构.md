# 常见数据结构

---

redis 是一种key-value的数据库，key一般是string 类型，不过value的类型多种多样：

---
## 通用命令

1. keys ： 查看符合模板的所有key
2. del： 删除一个指定的key
3. exists： 判断一个key是否存在
4. expire： 给一个key 设置有效期，有效期到期时该key会被自动删除
5. ttl： 查看一个key的剩余有效期， -1永久有效  -2 已被删除
6. Key的层级结构：
    
    redis的key运行多个单词的层级结构，多个单词之间使用':'隔开，建议格式如下：
    
        项目:业务:类型:id

---
## String 类型

String类型，也就是字符串类型，是Redis中最简单的存储类型。其value是字符串，不过根据字符串格式不同又可以分为三类：

| KEY    | VALUE     | 类型                   |
|--------|-----------|----------------------|
| MSG    | HELLOWPRD | 字符串                  |
| num    | 10        | int整数，可以做自增、自减操作     |
| score  | 92.5      | float浮点型，可以做自增、自减操作  |

不管是哪种格式，底层都是字节数组形式存储，只不过是编码方式不同。字符串类型的最大空间不能超过512M

常见命令：

| 命令          | 解释                                 |
|-------------|------------------------------------|
| SET         | 添加或者修改已经存在的一个string类型的键值对          |
| GET         | 根据key获取string类型的value              |
| MSET        | 批量添加多个string类型的键值对                 |
| MGET        | 根据多个key获取多个string类型的value          |
| INCR        | 让一个key对应的整型值自增1                    |
| INCRBY      | 让一个key对应的整型值自增指定步长                 |
| INCRBYFLOAT | 让一个浮点类型的数字自增并指定步长                  |
| SETNX       | 添加一个string类型的键值对，前提是这个key不存在，否则不执行 |
| SETEX       | 添加一个string类型的键值对，并且指定有效期           |

---

## hash 类型

Hash类型也叫散列类型，其value是一个无序字典，类似于java中的hashmap结构，hash结构可以将对象每个字段独立存储，可以针对单个字做crud

常见命令：

| 命令                   | 解释                                         |
|----------------------|--------------------------------------------|
| HSET key field value | 添加或者修改指定key的指定field的值                      |
| HGET key field       | 获取一个hash类型key的执行的field的值                   |
| HMSET                | 批量添加多个hash类型key的field的值                    |
| HMGET                | 批量获取多个hash类型的key的field的值                   |
| HGETALL              | 获取一个hash类型key中所有的field和其值                  |
| HKEYS                | 获取一个hash类型的key中的所有field                    |
| HAVLS                | 获取一个hash类型的key中的所有value                    |
| HINCRBY              | 让一个hash类型的key中的指定字段值自增指定步长                 |
| HSETNX               | 添加一个hash类型的key的field值，前提是这个field不存在，否则不执行  |

---

## list 类型

Redis中的list类型与java中的LinkedList类似，可以看做是一个双向链表结构。既可以支持正向检索也可以支持反向检索

特点：  有序、元素可以重复、插入和删除较快、查询速度一般

常见命令：

| 命令                   | 解释                                       |
|----------------------|------------------------------------------|
| LPUSH key element    | 向列表左侧插入一个或多个元素                           |
| LPOP key             | 移除并返回列表左侧的第一个元素，没有则返回nil                 |
| RPUSH key element    | 向列表右侧插入一个或多个元素                           |
| RPOP key             | 移除并返回列表右侧的第一个元素                          |
| LRANGE key start end | 返回一段角标范围内的所有元素                           |
| BLPOP和 BRPOP         | 与LPOP和RPOP类似，只不过在没有元素时等待指定时间，而不是直接返回nil  |

---

## set 类型

Redis 中的Set结构与Java中的HashSet类似，可以看作是一个value全为null的HashMap。因为也是一个hash表，所以具备与HashSet类似的特征

特点： 无序、元素不可重复、查找快、支持交集、并集、差集等功能

常见命令：

| 命令                   | 解释                |
|----------------------|-------------------|
| SADD key member...   | 向set中添加一个或多个元素    |
| SREM key member...   | 移除set中指定的元素       |
| SCARD key            | 返回set中元素的个数       |
| SISMEMBER key member | 判断一个元素是否存在于set中   |
| SMEMBERS             | 获取set中的所有元素       |
| SINTER key1 key2     | 求key1 与key2 的交集   |
| SDIFF key1 key2      | 求key1 与key2 的差集   |
| SUNION key key2      | 求key1 与 key2 的并集  |

---

## SortedSet类型

Redis中的SortedSet 是一个可排序的set集合，与java中的TreeSet有些类似，但是底层数据结构差别却很大。SortedSet中的每个元素都带有一个score属性，可以基于score属性对元素排序，底层实现是一个跳表（SkipList）加hash表

特点： 可排序、元素不重复、查询速度快

因为SortedSet的可排序特性，经常被用来实现排行榜这样的功能

常见命令：

| 命令                           | 解释                                   |
|------------------------------|--------------------------------------|
| ZADD key score member        | 添加一个或多个元素到sortd set，如果已经存在则更新其score值 |
| ZREM key member              | 删除sorted set中的一个指定元素                 |
| ZSCORE key member            | 获取sorted set中指定元素的score值             |
| ZRANK key member             | 获取sorted set中指定元素的排名                 |
| ZCARD key                    | 获取sorted set中元素个数                    |
| ZCOUNT key min max           | 统计score值在给定范围内所有元素的个数                |
| ZINCRBY key increment member | 让sorted set中指定元素按指定步长递增              |
| ZRANGE key min max           | 按照score 排序后，获取指定排名范围内的元素             |
| ZRANGEBYSCORE key min max    | 按照score排序后，获取指定score范围内的元素           |
| ZDIFF、ZINTER、ZUNION          | 求差集、交集、并集                            |

**注意： 所有的排名默认都是升序，如果需要降序则在命令的Z后面增加REV即可。例如：ZRANGE 升序 ---> ZREVRANGE 降序**



